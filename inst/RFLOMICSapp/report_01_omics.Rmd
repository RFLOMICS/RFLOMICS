# `r data` 

```{r }
# Create a directory to report each dataset results
dataDir <- paste0(outDir,"/",data)
dir.create(path = dataDir, showWarnings = FALSE)
```


```{r }

dataset.raw.SE <- NULL
dataset.SE     <- NULL
Diff.eval      <- FALSE
CoEx.eval      <- FALSE
Diff.ann.eval  <- FALSE
CoEx.ann.eval  <- FALSE
Diff.ann.eval_CPR <- FALSE
CoEx.ann.eval_CPR <- FALSE

dataset.raw.SE <- getRflomicsSE(rflomics.MAE, paste0(data,".raw")) 
dataset.SE     <- getRflomicsSE(rflomics.MAE, data)

if(!is.null(dataset.SE)){
  
  Diff.eval      <- !length(dataset.SE@metadata[["DiffExpAnal"]][["Validcontrasts"]]) == 0
  CoEx.eval      <- !length(dataset.SE@metadata[["CoExpAnal"]]$results) == 0
  Diff.ann.eval  <- !length(dataset.SE@metadata[["DiffExpEnrichAnal"]]$results) == 0
  CoEx.ann.eval  <- !length(dataset.SE@metadata[["CoExpEnrichAnal"]]$results) == 0
  
  Diff.ann.eval_CPR <- !length(dataset.SE@metadata[["DiffExpEnrichAnal"]]) == 0
  CoEx.ann.eval_CPR  <- !length(dataset.SE@metadata[["CoExpEnrichAnal"]]) == 0
}

```


```{r, eval=!is.null(dataset.SE)}

out <- NULL

out <- c(out, knitr::knit_child(paste0(path.package("RFLOMICS"), "/RFLOMICSapp/","report_03_data_explor.Rmd"),
                                quiet=TRUE))

knitr::asis_output(out)

```

<!-- differential analysis -->

```{r, eval=Diff.eval}

out <- NULL

out <- c(out, knitr::knit_child(paste0(path.package("RFLOMICS"), "/RFLOMICSapp/","report_04_diff_analysis.Rmd"),
                                quiet=TRUE))

knitr::asis_output(out)

```

<!-- enrichement analysis on DE G/P/M lists with clusterprofiler -->

```{r, eval=Diff.ann.eval_CPR}


out <- NULL
annot <- "DiffExpEnrichAnal"

for(ontology  in names(metadata(dataset.SE)[[annot]])){
out <- c(out, knitr::knit_child(paste0(path.package("RFLOMICS"), "/RFLOMICSapp/","report_06_annot_enrich_CPR.Rmd"),
                                quiet=TRUE))
}

knitr::asis_output(out)

```

<!-- co-expression analysis -->

```{r, eval=CoEx.eval}

out <- NULL


out <- c(out, knitr::knit_child(paste0(path.package("RFLOMICS"), "/RFLOMICSapp/","report_05_coexp_analysis.Rmd"),
                                quiet=TRUE))


knitr::asis_output(out)

```

<!-- enrichement analysis on cluster -->

```{r , eval=CoEx.ann.eval_CPR}


out <- NULL
annot <- "CoExpEnrichAnal"
#annot.name <- "Enrichement analysis of cluster(s)"

for(ontology  in names(metadata(dataset.SE)[[annot]])){
out <- c(out, knitr::knit_child(paste0(path.package("RFLOMICS"), "/RFLOMICSapp/","report_06_annot_enrich_CPR.Rmd"),
                                quiet=TRUE))
}

knitr::asis_output(out)

```
