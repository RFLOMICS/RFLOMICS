

<!-- <details> -->
<!--   <summary>`r listname`</summary> -->

### `r listname` {.tabset}

#### overrepresented plot

```{r , echo=FALSE, out.width = "50%", message=FALSE, warning=FALSE}

for(domain in unique(dataset.SE@metadata[[annot]]$results[[listname]]$Over_Under_Results$Domain)){
p <- Enrichment.plot(object = dataset.SE, listNames = listname, from = annot,
                                                  Over_Under = "overrepresented",
                                                  top = 50 , domain = domain)
print(p)
}

```

#### underrepresented plot

```{r , echo=FALSE, out.width = "70%", message=FALSE, warning=FALSE}

for(domain in unique(dataset.SE@metadata[[annot]]$results[[listname]]$Over_Under_Results$Domain)){
  p <- Enrichment.plot(object = dataset.SE, listNames = listname, from = annot,
                                                    Over_Under = "underrepresented",
                                                    top = 50 , domain = domain)
  print(p)
}

```

#### table

```{r , results='asis', echo = FALSE, out.width = "70%"}

  reactable(dataset.SE@metadata[[annot]][["results"]][[listname]][["Over_Under_Results"]],
            defaultPageSize = 6, searchable = TRUE, paginationType = "simple",
            columns = list(
              Decision = colDef(
                  style = function(value) {
                      color <- if (value == "overrepresented") {
                        "#008000"
                      } else if (value == "underrepresented") {
                        "#e00000"
                      }
                      list(fontWeight = 600, color = color)
                  }
                )
              )
            )

```

<!-- </details> -->


