---
title: "RFLOMICS report"
author: "Bioinfo team"
date: "`r format(Sys.time(), '%d %B, %Y')`"
bibliography: bibliography.bib
output: 
  html_document:
    df_print: paged
    toc: true
    toc_depth: 3
    toc_float:
      collapsed: true
      smooth_scroll: true
    number_sections: true
    theme: united
params: 
  pngDir: NA
  FEdata: NA
---


```{r , include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

```

```{r, echo=FALSE}
library(reactable)
```



```{r parameters, include=FALSE}

load(params$FEdata)
pngDir <- params$pngDir

```


# Experimental Design :


<!-- ## Sample sheet overview -->

<!-- ```{r Design, echo=FALSE, message=TRUE, warning=TRUE} -->
<!-- FlomicsMultiAssay@colData -->
<!-- ``` -->


* The experimental design of the  **`r length(FlomicsMultiAssay@metadata$projectName)` project** has **`r length(FlomicsMultiAssay@metadata$design@Factors.Type)` factor(s)**:  

`r paste0(paste0(str_c(names(FlomicsMultiAssay@metadata$design@Factors.Type),as.vector(FlomicsMultiAssay@metadata$design@Factors.Type),sep=": a "),collapse=" factor,  ")," factor",collapse="")`

* The statistical model written for the experiment is:  

**`r FlomicsMultiAssay@metadata$design@Model.formula`**


```{r CheckDesignExp, echo=FALSE, message=TRUE, warning=TRUE}
check <- CheckExpDesignCompleteness(Design)
```

* The number of replicates per condition are:


```{r checkDesignAsis, echo=FALSE, results="asis", eval=FALSE}
kable_styling(kable(check$count, row.names=FALSE, caption=NULL,  format="html"), font_size=12, full_width = F, position = "left")
```

* **`r check$message[2]`**

* The selected contrast(s) is (are):

```{r contrastSel, echo=FALSE, results="asis"}
kable_styling(kable(FlomicsMultiAssay@metadata$design@Contrasts.Sel[,c(5,2:3)], row.names=FALSE, caption=NULL, format="html"), font_size=12,full_width = F, position = "left")
```

## Datasets loaded:

```{r upsetSamples, echo=FALSE, fig.show = "hold", out.width = "50%", message=FALSE, warning=FALSE}
FlomicsMultiAssay@ExperimentList
#upsetSamples(FlomicsMultiAssay)
```


`r if(length(FlomicsMultiAssay@metadata$omicList) ==0 ) {"\\begin{comment}"}`


```{r analysis, message=FALSE, warning=FALSE, echo=FALSE, echo=FALSE, message=TRUE, warning=TRUE}

  out <- NULL
  for (omictype in names(FlomicsMultiAssay@metadata$omicList)){ 
    
    child <- paste0(omictype, ".Rmd")

    for (data in  FlomicsMultiAssay@metadata$omicList[[omictype]]){
      
      out <- c(out, knitr::knit_child(child, quiet=TRUE))  
    }
    
  }

knitr::asis_output(out)

```

`r if(length(FlomicsMultiAssay@metadata$omicList) == 0 ) {"\\end{comment}"}`

# R Session

```{r session, message=FALSE, warning=FALSE, echo=FALSE, echo=FALSE, message=TRUE, warning=TRUE}
devtools::session_info()
```


# Bibliographie


