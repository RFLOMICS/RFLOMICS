<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RFLOMICS • RFLOMICS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="RFLOMICS">
<meta property="og:description" content="RFLOMICS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RFLOMICS</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/RFLOMICS.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RFLOMICS-input-data.html">RFLOMICS input data</a>
    </li>
    <li>
      <a href="../articles/RFLOMICS-contrast.html">RFLOMICS contrast</a>
    </li>
    <li>
      <a href="../articles/RFLOMICS-install.html">RFLOMICS install</a>
    </li>
    <li>
      <a href="../articles/RFLOMICS-data-management.html">RFLOMICS data management</a>
    </li>
    <li>
      <a href="../articles/RFLOMICS-benchmark-coseq.html">RFLOMICS benchmark coseq</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/RFLOMICS-command-lines.html">RFLOMICS command lines</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="RFLOMICS_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>RFLOMICS</h1>
            
      
      
      <div class="hidden name"><code>RFLOMICS.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor" aria-hidden="true"></a>Introduction:</h1>
<p>RFLOMICS is based on proven statistical methods and pipeline for RNAseq data analysis (1). It is also based on functions allowing the automation of contrasts’s writting in R (2).</p>
<p>Data that will be used for this example have been provided by Loic Rajjou and Gwendal Cueff. They are included in the inst/ExampleFiles/ecoseed directory of the package. Briefly, A. thaliana’s transcriptomes have been obtained in the context of the study of seed germination and vigor. In particular, the author were interested in the influence of temperature (high, medium and low) and imbibition (Dry: DI, early imbibition: EI and late imbibition: LI) on gene’s expression.</p>
<ol style="list-style-type: decimal">
<li><p><a href="http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&amp;id=32426025&amp;retmode=ref&amp;cmd=prlinks" class="external-link">Ilana Lambert, Christine Paysant-Le Roux, Stefano Colella, and Marie-Laure Martin-Magniette (2020) DiCoExpress: a tool to process multifactorial RNAseq experiments from quality controls to co-expression analysis through differential analysis based on contrasts inside GLM models. <em>Plant Methods</em> vol. 16, p. 68</a></p></li>
<li><p>[Christine Paysant-Le Roux (2020), packageContrast_2020, unpublished]</p></li>
<li><p>[Projet ecoseed (), ]</p></li>
</ol>
</div>
<div id="run-rflomics" class="section level1">
<h1 class="hasAnchor">
<a href="#run-rflomics" class="anchor" aria-hidden="true"></a>Run RFLOMICS</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RFLOMICS</span><span class="op">)</span>
<span class="fu">runApp</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>In the left side of interface the different tab menu will be appear as the analysis progresses to guide the user.</p>
</div>
<div id="load-data" class="section level1">
<h1 class="hasAnchor">
<a href="#load-data" class="anchor" aria-hidden="true"></a>Load Data</h1>
<p>We start by set project name (its mandatory). Then we load the experimental design and different omics datasets.</p>
<div id="load-experimental-design" class="section level2">
<h2 class="hasAnchor">
<a href="#load-experimental-design" class="anchor" aria-hidden="true"></a>Load Experimental Design</h2>
<p>The experimental design file contains information about the readiness status of each sample (see link : vignette input ). As soon as this file is loaded, we can define the type (Biological factor : Bio; batch factor : batch; metadata information : meta) and reference level of each design factor.</p>
<ul>
<li><p><em>It is required to have minimum 1 biological factor (maximum 3 biological factors) and 1 batch factor. The order of the columns does not matter.</em></p></li>
<li><p><em>It possible to exclude samples from design. These samples will be excluded from the analysis even if they are present in the omics dataset matrix.</em></p></li>
</ul>
<div class="figure">
<img src="figure3.jpg" alt=""><p class="caption">interface capture</p>
</div>
</div>
<div id="load-omics-data" class="section level2">
<h2 class="hasAnchor">
<a href="#load-omics-data" class="anchor" aria-hidden="true"></a>Load Omics data</h2>
<p>For this tutoral we provide 3 datasets : RNAseq data (read counts), proteomics data (abundance of proteins), and metabolomics data (intensity of metabolites) (see link : vignette input). We must precise for each dataset its type of omics. We can give a suitable names to our dataset. By Default, they will be called respectively (set1, set2, set3).</p>
<p>As soon as data was loaded the <strong>Rflomics MultiAssayExperiment</strong> object is created (see link : data management). The upset representation provide detail about sample intersection of different datasets.</p>
</div>
<div id="completeness-check" class="section level2">
<h2 class="hasAnchor">
<a href="#completeness-check" class="anchor" aria-hidden="true"></a>Completeness check</h2>
<p>The design must be complete and as possible balanced. A <strong>Complete design (mandatory)</strong> mean that all possible combinations of biological factor’s level (called groups) where presents. A <strong>Balanced design (recommended)</strong> has an equal number of observations (replicates) for all groups.</p>
<p>This constraint is checked and represented in the form of graph (each square represent 1 group and each color level indicate the number of observations).</p>
<p><img src="completBalanced.png" width="50%"><img src="completNonBalanced.png" width="50%"></p>
<p><img src="completBalanced.png" alt="completeness"><img src="completNonBalanced.png" alt="completeness"></p>
</div>
</div>
<div id="set-statistical-framework" class="section level1">
<h1 class="hasAnchor">
<a href="#set-statistical-framework" class="anchor" aria-hidden="true"></a>Set statistical framework</h1>
<p>Interface provides models written from the simplest one to the most complete one. Only the two orders interaction terms between the biological factors will appear. Batch factor will never appear in interaction terms. In our case we choose the complete model.</p>
<p>All ‘a priori’ hypothesis (contrast) calculated from the chosen model are displayed (see link vignette contrast). The user must select those that correspond to the biological issues.</p>
<p>In our case we are studying the effect of temperature on seed germination (transition from the state of dormancy to the state of germination vigor). For that we select 3 average contrasts (see image) :</p>
<p>This statistical framework will be applied on all loaded datasets.</p>
<div class="figure">
<img src="figure2.jpg" alt=""><p class="caption">interface capture</p>
</div>
</div>
<div id="omics-data-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#omics-data-analysis" class="anchor" aria-hidden="true"></a>Omics data analysis</h1>
<p>3 Item menus appear in side bar menu that corresponds to the 3 loaded omics types.</p>
<p>For each dataset, different steps of data analysis are proposed as a tab panels. This analysis steps must be performed sequentially. But we can switch between datasets. However, you cannot perform a new task until the previous one is completed. It will have a progress bar that indicates that.</p>
<div id="data-exploratory" class="section level2">
<h2 class="hasAnchor">
<a href="#data-exploratory" class="anchor" aria-hidden="true"></a>Data Exploratory</h2>
<p>In this tab panel we access a data quality and we perform the appropriate data filtering and processing according to the type of omics.</p>
<p>By default, features with 0 count in all conditions are removed from the data.</p>
<p>Specifically for each data we have possibility to exclude samples or to select a subset of samples to analyze, provided the completeness condition is met.</p>
<div id="rnaseq-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#rnaseq-analysis" class="anchor" aria-hidden="true"></a>RNAseq analysis</h3>
<p>For RNAseq data, low expressed genes are filtered such that only genes whose cpm expression is greater than <strong>“CPM cutoff”</strong> in x samples are kept. The value of x is given by <strong>“Filtering strategy”</strong> (NbOfsample_over_cpm &lt;= NbConditions). In this example, there are 9 conditions. So, the number of gene with a CPM less than 5 in at least 9 samples are removed.</p>
<p>To correct for differences in sequencing depths (library size), RFlomics propose one method for normalization, <strong>“TMM method”</strong> from edgeR package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dge &lt;- edgeR::DGEList(counts=counts, group=groups)</span>
<span class="co"># dge &lt;- edgeR::calcNormFactors(dge, method="TMM")</span></code></pre></div>
<p>Pour evaluer la qualité des données et</p>
<p>à droite on visualise les graphe de couverture des données avant et prés filtre et un résumer du nombre de gène filtrès et un tableau avec les coef de normalisation. analyse</p>
<div class="figure">
<img src="figure1.jpg" alt=""><p class="caption">interface capture</p>
</div>
</div>
<div id="prot-or-metabo" class="section level3">
<h3 class="hasAnchor">
<a href="#prot-or-metabo" class="anchor" aria-hidden="true"></a>Prot or Metabo</h3>
<p>for these 2 omics choix methodo est le même…</p>
</div>
</div>
<div id="differiencial-expression-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#differiencial-expression-analysis" class="anchor" aria-hidden="true"></a>Differiencial expression analysis</h2>
<p>On peut visualiser la list des contrast qui ont été selectionner</p>
<p>Pour les données RNAseq -&gt; egeR</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># dge &lt;- edgeR::estimateGLMCommonDisp(dge, design=model_matrix)</span>
<span class="co"># dge &lt;- edgeR::estimateGLMTrendedDisp(dge, design=model_matrix)</span>
<span class="co"># dge &lt;- edgeR::estimateGLMTagwiseDisp(dge, design=model_matrix)    </span>
<span class="co"># fit.f &lt;- edgeR::glmFit(dge, design=model_matrix)</span>
<span class="co"># ResGlm &lt;- edgeR::glmLRT(fit.f, contrast = contrast.i)</span></code></pre></div>
<p>Pour les données prot -&gt; lima</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fit &lt;- limma::lmFit(count_matrix, model_matrix)   </span>
<span class="co"># ResGlm &lt;- limma::contrasts.fit(fit, contrasts = contrast.i)</span></code></pre></div>
<p>DAns la capture ci-dessou il sagit des données RNAseq</p>
<p>le resultats apprait à droite. chaque collapsebox correspond au resultats d’1 contrast.</p>
<p>recommendation –&gt; pvalue</p>
<p>Par defaut tous les contrst sont taguer comme valid</p>
<p>Le upset permet de representer intersection entre les DE des différnet contrast validé.</p>
<div class="figure">
<img src="figure1.jpg" alt=""><p class="caption">interface capture</p>
</div>
<p>il faut rajouter heatmap</p>
<div class="figure">
<img src="figure2.jpg" alt=""><p class="caption">capture diff resultat 1 contrast</p>
</div>
<div id="co-expression-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#co-expression-analysis" class="anchor" aria-hidden="true"></a>Co-Expression analysis</h3>
<!-- ![capture]() -->
</div>
<div id="annotation-and-enrichment-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#annotation-and-enrichment-analysis" class="anchor" aria-hidden="true"></a>Annotation and enrichment analysis</h3>
<!-- ![capture]() -->
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by First Last.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
